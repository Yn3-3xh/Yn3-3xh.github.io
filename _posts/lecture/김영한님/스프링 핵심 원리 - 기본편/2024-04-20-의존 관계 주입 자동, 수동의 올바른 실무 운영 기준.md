---
title: "[Lecture - 김영한님(스프링 핵심 원리 - 기본편)] 의존 관계 자동, 수동의 올바른 실무 운영 기준"
date : 2024-04-20 00:58:00 +09:00
categories : [Lecture - 김영한님(스프링 핵심 원리 - 기본편)]
tags : [lecture, inflearn, 김영한님, 스프링 핵심 원리 - 기본편, spring, spring boot, Autowired, Bean]
---

inflearn에서 김영한님 강의를 들으면서 내용을 정리해보자.   
[스프링 핵심 원리 - 기본편](https://www.inflearn.com/course/%EC%8A%A4%ED%94%84%EB%A7%81-%ED%95%B5%EC%8B%AC-%EC%9B%90%EB%A6%AC-%EA%B8%B0%EB%B3%B8%ED%8E%B8){:target="_blank"}

---

# 자동, 수동의 올바른 실무 운영 기준
## 편리한 자동 기능을 기본으로 사용하자!
어떤 경우에 컴포넌트 스캔과 **자동** 주입을 사용하고,   
어떤 경우에 설정 정보를 통해서 **수동**으로 빈을 등록하고, 의존 관계도 **수동**으로 주입해야 할까

결론은 스프링이 나오고 시간이 갈수록 점점 **자동을 선호**하는 추세이다.   
스프링은 `@Component`뿐만 아니라 `@Controller`, `@Service`, `@Repository`처럼 계층에 맞추어 일반적인 **애플리케이션 로직을 자동으로 스캔**할 수 있도록 지원한다.   
또한 최근 스프링 부트는 **컴포넌트 스캔을 기본으로 사용**하고, 스프링 부트의 다양한 **스프링 빈들도 조건이 맞으면 자동으로 등록**하도록 설계했다.

설정 정보를 기반으로 애플리케이션을 구성하는 부분과 실제 동작하는 부분을 명확하게 나누는 것이 이상적이지만,   
개발자 입장에서 스프링 빈을 하나 등록할 때 `@Component`만 넣어주면 끝나는 일을 `@Configuration` 설정 정보에 가서 `@Bean`을 적고, 객체를 생성하고, 주입할 대상을 일일이 적어주는 과정은 상당히 번거롭다.   
또 관리할 빈이 많아서 설정 정보가 커지면 설정 정보를 관리하는 것 자체가 부담이 된다.   
그리고 결정적으로 **자동 빈 등록을 사용해도 OCP, DIP를 지킬 수 있다.**

## 수동 빈 등록은 언제 사용할까?
애플리케이션은 크게 업무 로직과 기술 지원 로직으로 나눌 수 있다.
* 업무 로직 빈
  * 웹을 지원하는 컨트롤러, 핵심 비즈니스 로직이 있는 서비스, 데이터 계층의 로직을 처리하는 리포지토리 등이 모두 업무 로직이다.
  * 보통 비즈니스 요구사항을 개발할 때 추가되거나 변경된다.
* 기술 지원 빈
  * 기술적인 문제나 공통 관심사(AOP)를 처리할 때 주로 사용된다.
  * DB 연결이나, 공통 로그 처리처럼 업무 로직을 지원하기 위한 하부 기술이나 공통 기술이다.

**업무 로직**은 숫자도 매우 많고, 한번 개발해야 하면 컨트롤러, 서비스, 리포지토리처럼 어느정도 유사한 패턴이 있다.   
이런 경우 **자동 기능**을 적극 사용하는 것이 좋다.   
보통 문제가 발생해도 어떤 곳에서 문제가 발생했는지 명확하게 파악하기 쉽다.

**기술 지원 로직**은 업무 로직과 비교해서 그 수가 매우 적고, 보통 애플리케이션 전반에 걸쳐서 광범위하게 영향을 미친다.   
그리고 업무 로직은 문제가 발생했을 때 어디가 문제인지 명확하게 잘 들어나지만,   
기술 지원 로직은 적용이 잘 되고 있는지 아닌지 조차 파악하기 어려운 경우가 많다.   
그래서 이런 기술 지원 로직들은 가급적 **수동 빈 등록**을 사용해서 명확하게 들어내는 것이 좋다.   
즉, 애플리케이션에 광범위하게 영향을 미치는 기술 지원 객체는 수동 빈으로 등록해서 설정 정보에 바로 나타나게 하는 것이 유지보수하기 좋다.

### 비즈니스 로직 중에서 다형성을 적극 활용할 때
예를 들어, `DiscountService`가 의존관계 자동 주입으로 `Map<String, DiscountPolicy>`에 주입을 받는 상황에서 어떤 빈들이 주입될 지, 각 빈들의 이름은 무엇일지   
자동 등록을 사용하고 있기 때문에 코드만 보고 한눈에 쉽게 파악하기 힘들다.

이런 경우 쉽게 파악하기 위해서 **수동 빈으로 등록**하거나 **자동이면 특정 패키지에 같이 묶어**두는게 좋다.
```java
@Configuration
public class DiscountPolicyConfig {
    
    @Bean
    public DiscountPolicy rateDiscountPolicy() {
        return new RateDiscountPolicy();
    }
    
    @Bean
    public DiscountPolicy fixDiscountPolicy() {
        return new FixDiscountPolicy();
    }
}
```
위 코드처럼 별도의 **설정 정보를 만들고 수동으로 등록**하면 설정 정보만 봐도 한눈에 빈의 이름은 물론이고, 어떤 빈들이 주입되는지 **한눈에 파악**할 수 있다.   
그래도 **빈 자동 등록을 사용**하고 싶으면 파악하기 좋게 `DiscountPolicy`의 구현 빈들만 따로 모아서 **특정 패키지**로 모아두는게 좋다.

---

# 정리
* 편리한 자동 기능을 기본으로 사용
* 직접 등록하는 기술 지원 객체는 수동으로 등록
* 다형성을 적극 활용하는 비즈니스 로직은 수동 등록을 고민
